# Демонстрация SQL­‑инъекции II порядка

## Порядок эксплуатации уязвимости

1. Запустить клиент MySQL: `mysql -u root -p`.
2. В клиенте MySQL создать базу данных: `source network.sql`.
3. При необходимости изменить учётные сведения базы данных (`credentials.json`).
4. Запустить сервер HTTP: `php -S 127.0.0.1:8080`.
5. Открыть в браузере <http://127.0.0.1:8080/register/>.
6. Зарегистрировать пользователей с именами `vasya` и `vasya';-- `, при этом желательно задать разные пароли.
7. В клиенте MySQL выполнить: `SELECT * FROM users;`.
8. Открыть в браузере <http://127.0.0.1:8080/profile/>.
9. Сменить пароль.
10. В клиенте MySQL выполнить: `SELECT * FROM users;`.

## Пояснение

1. Добропорядочный пользователь регистрируется под именем `vasya` в социальной сети.
2. Злоумышленник, намереваясь взломать учётную запись `vasya`, регистрируется под именем `vasya';-- `.
3. Злоумышленник проходит аутентификацию как `vasya';-- ` и, используя штатные средства, подаёт запрос на изменение пароля. В результате SQL­‑инъекции II порядка известный злоумышленнику пароль устанавливается не для пользователя `vasya';-- `, а для пользователя `vasya`. Атака завершена. Хеширование паролей атаку не предотвращает.
4. Злоумышленник проходит аутентификацию как `vasya`.
